# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1mgiCPWeh9yxe09QNeIY_QDEtRJBJHcgX
"""

import streamlit as st
from fitsflow import core   # assumes your folder is fitsflow/ and has core.py
import matplotlib.pyplot as plt

# ----------------- Page Config -----------------
st.set_page_config(
    page_title="AstroFlow - FITS Analysis",
    page_icon="‚ú®",
    layout="wide"
)

st.title("üî≠ AstroFlow")
st.markdown("Upload your **FITS files** and run quick spectral analysis right in the browser.")

# Sidebar
st.sidebar.header("‚öôÔ∏è Settings")
smooth_factor = st.sidebar.slider("Smoothing Factor", 1, 50, 10)
normalize = st.sidebar.checkbox("Normalize Spectrum", value=True)

# File uploader
uploaded_files = st.file_uploader(
    "Upload one or more FITS files:",
    type=["fits"],
    accept_multiple_files=True
)

if uploaded_files:
    st.success(f"{len(uploaded_files)} file(s) uploaded successfully ‚úÖ")

    results = []

    for file in uploaded_files:
        with st.spinner(f"Processing {file.name}..."):
            try:
                # Run your analysis function from core.py
                spectrum = core.analyze_fits(file, smooth=smooth_factor, normalize=normalize)

                # Plot results
                fig, ax = plt.subplots()
                ax.plot(spectrum['wavelength'], spectrum['flux'], color="cyan")
                ax.set_title(f"Spectrum - {file.name}")
                ax.set_xlabel("Wavelength")
                ax.set_ylabel("Flux")

                st.pyplot(fig)
                results.append(spectrum)

            except Exception as e:
                st.error(f"Error processing {file.name}: {e}")

    st.success("‚úÖ Analysis complete!")

else:
    st.info("‚¨ÜÔ∏è Upload FITS files to begin analysis.")

# Footer
st.markdown("---")
st.caption("Built with ‚ù§Ô∏è by AstroFlow | Prototype for NASA Space Apps üöÄ")
